---
output: github_document
---

```{r echo=FALSE, results = 'asis'}
pkg <- 'seriation'

source("https://raw.githubusercontent.com/mhahsler/pkg_helpers/main/pkg_helpers.R")
pkg_title(pkg)
```


This package provides the infrastructure for ordering objects 
with an implementation of several
[seriation](https://en.wikipedia.org/wiki/Seriation_(archaeology))/sequencing/[ordination](https://en.wikipedia.org/wiki/Ordination_(statistics)) techniques to reorder matrices, dissimilarity
matrices, and dendrograms (see below for a full list). Also provides (optimally) reordered heatmaps, 
color images and clustering visualizations like dissimilarity plots, and
visual assessment of cluster tendency plots (VAT and iVAT).

## Available seriation methods to reorder dissimilarity data

### Optimization

 These methods try to optimize a seriation criterion directly typically using a heuristic approach.
 
 *  **ARSA** - optimize the linear seriation critreion using simulated annealing   
 *  **Branch-and-bound** to minimize the unweighted/weighted column gradient 
 *  **GA** - Genetic algorithm with warm start to optimize any seriation criteria
 *  **GSA** - General simulated annealing to optimize any seriation criteria
 *  **QAP** - Quadratic assignment problem heuristic (optimizes 2-SUM, linear seriation, 
          inertia, banded anti-Robinson form)
 *  **Spectral** seriation to optimize the 2-SUM criterion (unnormalized, normalized) 
 *  **TSP** - Traveling sales person solver to minimize the Hamiltonian path length 
 
### Dimensionality reduction  

Find a seriation order by reducing the dimensionalty to 1 dimension. This is typically done
by minimizing a stress measure or the reconstruction error.

 *  **MDS** - classical metric multidimensional scaling
 *  **MDS (angle)** - order by the angle in 2D principal coordinates space
 *  **isoMDS** -  1D Krusakl's non-metric multidimensional scaling
 *  **isomap** -  1D isometric feature mapping ordination
 *  **monoMDS** - order along 1D global and local non-metric multidimensional scaling using monotone regression (NMDS)
 *  **metaMDS** - 1D non-metric multidimensional scaling (NMDS) with stable solution from random starts
 *  **Sammon** - Order along the 1D Sammon's non-linear mapping
 *  **smacof** - 1D MDS using majorization (ratio MDS, interval MDS, ordinal MDS)
 *  **TSNE** - Order along the 1D t-distributed stochastic neighbor embedding (t-SNE)
 *  **UMAP** - Order along the 1D embedding produced by uniform manifold approximation and projection
 *  **VAE** - Order along the 1D embedding produced by a variational autoencoder
 
### Dendrogram leaf order

These methods create a dendrogram using hierarchical clustering and then derive the seriation order from the leaf order in the dendrogram. Leaf reordering may be applied.
 
 *  **DendSer** - Dendrogram seriation heuristic to optimize various criteria
 *  **GW** - Hierarchical clustering reordered by the Gruvaeus and Wainer heuristic 
 *  **HC** - Hierarchical clustering (single link, avg. link, complete link) 
 *  **OLO** - Hierarchical clustering with optimal leaf ordering 
 
### Other Methods

 *  **Identity** permutation 
 *  **OPTICS** - Order of ordering points to identify the clustering structure
 *  **R2E** - Rank-two ellipse seriation 
 *  **Random** permutation
 *  **Reverse** order
 *  **SPIN** - Sorting points into neighborhoods (neighborhood algorithm, side-to-site algorithm)
 *  **VAT** - Order of the visual assessment of clustering tendency
  
A detailed comparison of the methods is available in the paper 
[An experimental comparison of seriation methods for one-mode two-way data.](http://dx.doi.org/10.1016/j.ejor.2016.08.066) (read the [preprint](https://michael.hahsler.net/research/paper/EJOR_seriation_2016.pdf)).
  
  

## Available seriation methods to reorder data matrices, count tables, and data.frames  

### Seriating rows and columns simultaneously

Row and column order influence each other.

 *  **BEA** - Bond Energy Algorithm to maximize the measure of effectiveness (ME) 
 *  **BEA_TSP** - TSP to optimize the measure of effectiveness
 *  **CA** - calculates a correspondence analysis of a matrix of frequencies (count table)
      and reorders according to the scores on a correspondence analysis dimension

### Seriating rows and columns separately using dissimilarities

 *  **Heatmap** - reorders rows and columns independently by calculation row/column distances 
      and then applying a seriation method for dissimilarities (see above)

### Seriate rows using the data matrix

These methods need access to the data matrix instead of dissimilarities
to reorder objects (rows).

 *  **LLE** reorder along a 1D locally linear embedding
 *  **Means** - reorders using row and column means
 *  **PCA** - orders along the first principal component
 *  **PCA (angle)** - orders by the angle on the projection on the first two principal components
 *  **TSNE** - Order along the 1D t-distributed stochastic neighbor embedding (t-SNE)
 *  **UMAP** - Order along the 1D embedding produced by uniform manifold approximation and projection
 *  **VAE** - Order along the 1D embedding produced by a variational autoencoder

### Other methods
 
 *  **Identity** permutation 
 *  **Random** permutation 
 *  **Reverse** order

```{r echo=FALSE, results = 'asis'}
pkg_install(pkg)
```

## Usage

Load library, read data and calculate distances. Then use default seriation. The used dataset 
contains the joint probability of disagreement between Supreme Court Judges during the period
from 1995 to 2002.
```{r}
library(seriation)
data("SupremeCourt")

SupremeCourt

d <- as.dist(SupremeCourt)
order <- seriate(d)
order
```

Get the resulting permutation vector.
```{r}
get_order(order)
```

```{r seriation,  fig.show="hold", out.width="50%"}
pimage(d, main = "judges in original alphabetical order")
pimage(d, order, main = "judges reordered by seriation")
```



Compare several available quality metrics.
```{r}
rbind(
 alphabetical = criterion(d),
 seriated = criterion(d, order)
)
```

Some seriation methods also return a configuration to judge how close objects are 
to each other.
```{r configuration, fig.show="hold", fig.height = 3}
get_config(order)

plot_config(order)
```



## References

* Michael Hahsler, Kurt Hornik and Christian Buchta, [Getting Things in Order: An Introduction to the R Package seriation,](http://dx.doi.org/10.18637/jss.v025.i03) _Journal of Statistical Software,_ 25(3), 2008.
* Michael Hahsler. [An experimental comparison of seriation methods for one-mode two-way data.](http://dx.doi.org/10.1016/j.ejor.2016.08.066) _European Journal of Operational Research,_ 257:133-143, 2017. (read the [preprint](https://michael.hahsler.net/research/paper/EJOR_seriation_2016.pdf))
* [Reference manual for package seriation.](https://www.rdocumentation.org/packages/seriation/)

